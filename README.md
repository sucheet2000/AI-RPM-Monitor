# ğŸ«€ AI-RPM Monitor

**AI-Powered Remote Patient Monitoring System**

A full-stack real-time patient vitals monitoring platform featuring edge AI classification, Kafka event streaming, and an interactive React dashboard.

![Tech Stack](https://img.shields.io/badge/Python-3.9+-blue?logo=python)
![React](https://img.shields.io/badge/React-18-61DAFB?logo=react)
![Kafka](https://img.shields.io/badge/Kafka-Streaming-231F20?logo=apachekafka)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-15-4169E1?logo=postgresql)
![Docker](https://img.shields.io/badge/Docker-Compose-2496ED?logo=docker)

---

## ğŸ“‹ Table of Contents

- [Overview](#-overview)
- [Architecture](#-architecture)
- [Quick Start](#-quick-start)
- [Running the Services](#-running-the-services)
- [API Endpoints](#-api-endpoints)
- [Running Tests](#-running-tests)
- [Project Structure](#-project-structure)

---

## ğŸ¯ Overview

AI-RPM Monitor simulates a real-world remote patient monitoring scenario:

1. **Edge devices** capture patient vitals (Heart Rate, SpOâ‚‚, Temperature)
2. **AI classifier** (Isolation Forest) categorizes readings as Normal/Warning/Critical
3. **Kafka** streams classified data in real-time
4. **Flask API** consumes and persists data to PostgreSQL
5. **React Dashboard** visualizes vitals with live updates and critical alerts

---

## ğŸ— Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Edge Producer  â”‚â”€â”€â”€â”€â–¶â”‚    Kafka    â”‚â”€â”€â”€â”€â–¶â”‚   Consumer   â”‚
â”‚  (Python + ML)  â”‚     â”‚   (vitals)  â”‚     â”‚  (Flask API) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ React Dashboard â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  PostgreSQL  â”‚
â”‚   (Tailwind)    â”‚      REST API          â”‚   Database   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ Quick Start

### Prerequisites

-   **Docker & Docker Compose** (v2.0+)
-   **Python 3.9+**
-   **Node.js 18+** (for frontend)
-   **Gemini API Key** (for AI Triage)

### 1. Clone and Setup

```bash
git clone <repository-url>
cd AI-RPM-Monitor
```

### 2. Configure Environment

Create a `.env` file for your API key:

```bash
cp .env.example .env
# Edit .env and add your GEMINI_API_KEY
```

### 3. Start Infrastructure (Docker)

Start PostgreSQL, Kafka, and Zookeeper:

```bash
docker-compose up -d
```

Expected output:
```
NAME              STATUS          PORTS
rpm-kafka         running         0.0.0.0:9092->9092/tcp
rpm-postgres      running         0.0.0.0:5432->5432/tcp
rpm-zookeeper     running         0.0.0.0:2181->2181/tcp
rpm-kafka-init    exited (0)      # Creates 'vitals' topic
```

### 4. Start the Application Services

You will need **3 separate terminal windows**:

**Terminal 1: Consumer Service (Back-end)**
```bash
pip install -r requirements.txt
python -m consumer.app
```
*Runs on http://localhost:5001*

**Terminal 2: Vitals Producer (Data Simulator)**
```bash
python vitals_producer.py
```
*Generates real-time synthetic patient data*

**Terminal 3: Frontend Dashboard**
```bash
cd frontend
npm install
npm start
```
*Runs on http://localhost:3000*

---

## ğŸ–¥ Using the Dashboard

1.  Open **http://localhost:3000**
2.  Select a patient from the list (e.g., `patient-demo001` if generated).
3.  **Real-time Vitals:** Watch the Live Heart Rate chart update every 10s.
4.  **Critical Alerts:** If the producer generates a critical value, a **Red Alert Banner** will appear.
5.  **AI Triage:** Click the banner to view the **Structured JSON Report** generated by Gemini.
6.  **Wellness Report:** Review the "Patient Wellness Report" card for the plain-text clinical summary.

---

## ğŸ”§ Troubleshooting

**Port Conflicts?**
- Kafka needs port `9093` (external) and `9092` (internal).
- Backend runs on `5001` (to avoid macOS Control Center on 5000).

**"Connection Error" in Dashboard?**
- Ensure the Consumer API is running in Terminal 1.
- Check browser console for network errors.

**No LLM Summaries?**
- Verify `GEMINI_API_KEY` is set in `.env`.
- Check Consumer logs for "ğŸ¤– LLM Triage completed".

---

## ğŸ“¡ API Endpoints

Base URL: `http://localhost:5001`

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/` | GET | Health check |
| `/api/vitals/<patient_id>` | GET | Last 24h of vitals |
| `/api/alerts/<patient_id>` | GET | Critical alerts only |
| `/api/summaries/<patient_id>` | GET | LLM wellness summaries |
| `/api/stats` | GET | System-wide statistics |

### Example Requests

```bash
# Get patient vitals (last 24 hours)
curl http://localhost:5001/api/vitals/patient-abc123

# Get critical alerts
curl http://localhost:5001/api/alerts/patient-abc123

# Get system stats
curl http://localhost:5001/api/stats
```

---

## ğŸ§ª Running Tests

### Run All Tests

```bash
pytest -v
```

### Run Specific Test Suites

```bash
# Test the AI classifier
pytest tests/test_classifier.py -v

# Test the API endpoints
pytest tests/test_api.py -v

# Test Flask routes
pytest tests/test_routes.py -v
```

### Expected Output

```
========================= test session starts =========================
collected 51 items

tests/test_classifier.py::TestEdgeClassifier::test_normal_reading PASSED
tests/test_classifier.py::TestSyntheticCriticalData::test_critical_low_spo2 PASSED
tests/test_api.py::TestGetVitalsEndpoint::test_get_vitals_returns_200 PASSED
...
========================= 51 passed in 33.00s =========================
```

---

## ğŸ“ Project Structure

```
AI-RPM-Monitor/
â”œâ”€â”€ docker-compose.yml       # Infrastructure (Postgres, Kafka, Zookeeper)
â”œâ”€â”€ requirements.txt         # Python dependencies
â”œâ”€â”€ vitals_producer.py       # Kafka producer with AI classifier
â”œâ”€â”€ edge_classifier.py       # scikit-learn anomaly detection
â”œâ”€â”€ run.py                   # Flask app entry point
â”‚
â”œâ”€â”€ app/                     # Original Flask app
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ routes.py
â”‚   â””â”€â”€ models.py
â”‚
â”œâ”€â”€ consumer/                # Kafka consumer service
â”‚   â”œâ”€â”€ app.py               # Flask API server
â”‚   â”œâ”€â”€ models.py            # VitalsRecord, LLMSummary tables
â”‚   â””â”€â”€ kafka_consumer.py    # Robust Kafka consumer
â”‚
â”œâ”€â”€ frontend/                # React + Tailwind dashboard
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tailwind.config.js
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ App.jsx
â”‚       â”œâ”€â”€ components/
â”‚       â”‚   â”œâ”€â”€ VitalsChart.jsx
â”‚       â”‚   â”œâ”€â”€ AlertBanner.jsx
â”‚       â”‚   â”œâ”€â”€ WellnessCard.jsx
â”‚       â”‚   â””â”€â”€ Modal.jsx
â”‚       â”œâ”€â”€ pages/
â”‚       â”‚   â”œâ”€â”€ HomePage.jsx
â”‚       â”‚   â””â”€â”€ PatientDashboard.jsx
â”‚       â””â”€â”€ services/
â”‚           â””â”€â”€ api.js
â”‚
â””â”€â”€ tests/                   # pytest test suites
    â”œâ”€â”€ test_classifier.py   # 31 classifier tests
    â”œâ”€â”€ test_api.py          # 20 API endpoint tests
    â””â”€â”€ test_routes.py       # Basic route tests
```

---

## ğŸ¨ Dashboard Features

- **Real-time Vitals Chart** â€” Interactive time-series visualization with Recharts
- **Critical Alert Banner** â€” Sticky red banner for immediate attention
- **LLM Summary Modal** â€” Click alerts to view raw JSON clinician data
- **Wellness Report Card** â€” AI-generated patient analysis
- **Auto-refresh** â€” Dashboard polls for updates every 10 seconds

---

## ğŸ›  Technology Stack

| Layer | Technology |
|-------|------------|
| **Frontend** | React 18, Tailwind CSS, Recharts, React Router |
| **Backend** | Flask, Flask-SQLAlchemy, confluent-kafka |
| **AI/ML** | scikit-learn (Isolation Forest) |
| **Database** | PostgreSQL 15 |
| **Messaging** | Apache Kafka |
| **Infrastructure** | Docker Compose |
| **Testing** | pytest, pytest-flask |

---

## ğŸ“œ License

MIT License â€” See [LICENSE](LICENSE) for details.

---

<div align="center">
  <sub>Built with â¤ï¸ for modern healthcare monitoring</sub>
</div>
